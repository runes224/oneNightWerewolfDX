(function(e){function t(t){for(var s,i,o=t[0],c=t[1],u=t[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(m.length)m.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(s=!1)}s&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},r={app:0},a=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var s=n("85ec"),r=n.n(s);r.a},1008:function(e,t,n){},"1b4f":function(e,t,n){},"4a2a":function(e,t,n){"use strict";var s=n("1008"),r=n.n(s);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("div",[n("v-app-bar",{attrs:{color:"gray accent-4",dark:""}},[n("v-toolbar-title",[e._v("ワンナイト人狼DX")]),n("v-spacer"),e.nameFlag?n("div",{staticStyle:{display:"inline-flex","padding-bottom":"0"}},[n("p",[e._v("ログインユーザ：")]),n("p",[e._v(e._s(e.users.length)+"人")])]):e._e()],1)],1),n("v-container",[n("div",{attrs:{id:"app"}},[e.isConnected?e._e():n("button",{on:{click:e.connect}},[e._v("接続")]),e.isConnected?n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.nameFlag,expression:"!nameFlag"}],staticClass:"register-name"},[n("register",{attrs:{users:this.users},on:{chileEvent:e.registerName}})],1),"start"==e.status?n("div",[n("choice-role",{attrs:{usersCount:this.users.length},on:{childEvent:e.startGame}})],1):e._e(),"start"!=e.status&&e.nameFlag?n("div",{staticClass:"direction-column"},[n("Timer",{attrs:{seccond:e.nightPeriodSecond},on:{startVoting:e.startVotingParent}}),"voting"==e.status?n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{scrollable:"","max-width":"25rem"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[n("v-btn",e._g({attrs:{color:"red lighten-2",dark:""}},s),[e._v("投票する")])]}}],null,!1,842793146),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[e._v("投票する相手を選択してください")]),n("v-divider"),n("v-card-text",{staticStyle:{height:"300px"}},[n("v-radio-group",{attrs:{column:""},model:{value:e.votedUser,callback:function(t){e.votedUser=t},expression:"votedUser"}},e._l(this.otherUsers,(function(e){return n("v-radio",{key:e,attrs:{label:e,value:e}})})),1)],1),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("キャンセル")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.vote}},[e._v("送信")])],1)],1)],1)],1):e._e(),n("div",{attrs:{id:"inside-cards"}},e._l(e.insideCards,(function(t){return n("div",{key:t.name,staticClass:"direction-column card-area",on:{click:function(t){return e.nightActionInside()}}},[n("div",{staticClass:"card",class:t.design})])})),0),n("v-divider"),n("div",{attrs:{id:"outside-cards"}},e._l(e.outsideCards,(function(t){return n("div",{key:t.name,class:["direction-column","card-area",e.isMyCard(t.name)],on:{click:function(n){return e.nightActionOutside(t)}}},[n("div",{staticClass:"card",class:t.design}),e._v(" "+e._s(t.name)+" "),"resultAnnouncement"==e.status?n("span",{staticStyle:{color:"black","font-weight":"initial"}},[e._v("投票数："+e._s(t.votedNum))]):e._e()])})),0)],1):e._e(),e.nameFlag?n("div",{staticClass:"kakomi"},e._l(e.messages,(function(t){return n("ul",{key:t,staticStyle:{"list-style":"none"}},[n("li",[e._v(e._s(t))]),n("v-divider")],1)})),0):e._e()]):e._e()])])],1)},a=[],i=(n("a4d3"),n("e01a"),n("4de4"),n("4160"),n("d81d"),n("a434"),n("b0c0"),n("4fad"),n("ac1f"),n("466d"),n("159b"),n("2909")),o=n("3835"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"timer"},[n("div",{staticClass:"time",domProps:{innerHTML:e._s(e.msg)}}),e.startVotingFlag?e._e():n("div",[e._v("残り時間："+e._s(e.formatTime))])])},u=[],l=(n("d3b7"),n("25f0"),{name:"timer",props:["seccond"],data:function(){return{min:0,sec:this.seccond,timerObj:null,msg:"",doneNightActionFlag:!1,startVotingFlag:!1}},methods:{count:function(){if(this.sec<=0&&this.min>=1)this.min--,this.sec=59;else if(this.sec<=0&&this.min<=0){if(1==this.doneNightActionFlag)return clearTimeout(this.timerObj),this.startVotingFlag=!0,this.msg="議論の時間が終わりました。<br>投票をしてください。",this.$emit("startVoting"),!1;this.min=5,this.msg="夜が明けました。議論を始めてください。",this.doneNightActionFlag=!0}else this.sec--},start:function(){var e=this;this.timerObj=setInterval((function(){e.count()}),1e3)},stop:function(){clearInterval(this.timerObj)}},watch:{second:{immediate:!0,handler:function(){this.msg="夜の行動を行ってください。",this.start()}}},computed:{formatTime:function(){var e=[this.min.toString(),this.sec.toString()].map((function(e){return e.length<2?"0"+e:e}));return e[0]+":"+e[1]}}}),d=l,m=(n("be89"),n("2877")),h=Object(m["a"])(d,c,u,!1,null,"1561ff36",null),f=h.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"register"},[n("v-form",{ref:"register_name_form",staticStyle:{width:"15rem"}},[n("v-text-field",{attrs:{label:"名前を入力してください",rules:[e.required,e.notDuplicated]},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),n("v-btn",{staticClass:"btn",on:{click:e.registerName}},[e._v("送信")])],1)},p=[],g={name:"choiceRole",props:["users"],data:function(){var e=this;return{name:"",required:function(e){return!!e||"必ず入力してください"},notDuplicated:function(t){return 0===e.users.filter((function(e){return e===t})).length||"他のユーザと名前が重複しています"}}},methods:{registerName:function(){this.$refs.register_name_form.validate()&&this.$emit("chileEvent",this.name)}}},b=g,C=(n("d016"),n("6544")),_=n.n(C),y=n("8336"),N=n("4bd4"),O=n("8654"),k=Object(m["a"])(b,v,p,!1,null,"220c59ad",null),S=k.exports;_()(k,{VBtn:y["a"],VForm:N["a"],VTextField:O["a"]});var w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"margin_1"},[e._v("残り"+e._s(e.remainCounter)+"枚、役職を増やしてください。")]),e._l(e.roles,(function(t){return n("div",{key:t.name,staticClass:"counter-area"},[n("div",{staticClass:"role-name"},[e._v(e._s(t.name)+"：")]),n("number-input-spinner",{attrs:{min:0,max:10,step:1,integerOnly:!0},model:{value:t.number,callback:function(n){e.$set(t,"number",n)},expression:"role.number"}})],1)})),n("v-btn",{staticClass:"margin_1",attrs:{color:"primary"},on:{click:e.startGame}},[e._v("ゲーム開始")])],2)},x=[],V=n("b85c"),j={name:"choise",props:["usersCount"],data:function(){return{roles:[{name:"村人",number:0,description:"狼の嘘を見破りましょう"},{name:"人狼",number:2,descriptioxn:"村人を欺きましょう"},{name:"占い師",number:1,description:"誰かのカードか余ったカードを確認できます"},{name:"怪盗",number:1,description:"誰かのカードと交換できます"},{name:"軍人",number:0,description:"村人よりちょっとだけ強いです"},{name:"狂人",number:0,description:"人狼の勝利があなたの勝利です"}]}},computed:{remainCounter:function(){var e,t=0,n=Object(V["a"])(this.roles);try{for(n.s();!(e=n.n()).done;){var s=e.value;t+=s.number}}catch(r){n.e(r)}finally{n.f()}return this.usersCount-t+2}},methods:{startGame:function(){this.$emit("childEvent",this.roles)}}},F=j,A=(n("4a2a"),Object(m["a"])(F,w,x,!1,null,"30c73a78",null)),J=A.exports;_()(A,{VBtn:y["a"]});var T={components:{Timer:f,Register:S,ChoiceRole:J},name:"App",data:function(){return{yourName:"",role:"",nameFlag:!1,inputMessage:"",connection:null,status:"",doneNightActionFlag:!1,dialog:!1,votedUser:"",votedCounter:0,nightPeriodSecond:0,messages:[],users:[],insideCards:[],outsideCards:[],resultOutsideCards:[],roles:[]}},computed:{isConnected:function(){return null!==this.ws},otherUsers:function(){var e=this;return this.users.filter((function(t){return t!==e.yourName}))}},methods:{isMyCard:function(e){return this.yourName===e?"myCard":""},registerName:function(e){this.yourName=e;var t={action:"registerName",data:this.yourName};this.nameFlag=!0,this.status="start",this.connection.send(JSON.stringify(t))},startGame:function(e){this.roles=e;var t={action:"startGame",roles:this.roles,users:this.users};this.connection.send(JSON.stringify(t))},nightActionInside:function(){if("占い師"==this.role&&0==this.doneNightActionFlag)for(var e=0;e<2;e++){var t=this.insideCards[e];t.design=t.role,this.insideCards.splice(e,1,t),this.messages.push("中央の伏せカード"+(e+1)+":"+t.role)}this.doneNightActionFlag=!0},nightActionOutside:function(e){var t=this;if(!this.doneNightActionFlag){if("占い師"==this.role)e.design=e.role,this.outsideCards.splice(e.num,1,e),this.messages=[],this.messages.push(e.name+"さんのカードは"+e.role+"でした");else if("怪盗"==this.role){e.design=e.role;var n=this.outsideCards.filter((function(e){return e.name===t.yourName}))[0];n.name=e.name,e.name=this.yourName;var s=n.num,r=e.num;n.num=r,e.num=s,this.outsideCards.splice(s,1,e),this.outsideCards.splice(r,1,n),this.messages=[],this.messages.push(n.name+"さんのカード（"+e.role+"）と交換しました")}this.doneNightActionFlag=!0}},startVotingParent:function(){this.status="voting"},vote:function(){this.dialog=!1;var e={action:"vote",votedUser:this.votedUser,role:this.role,outsideCards:this.outsideCards};this.connection.send(JSON.stringify(e))}},created:function(){var e=this;console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://oy4l1o06be.execute-api.ap-northeast-1.amazonaws.com/prod"),this.connection.onmessage=function(t){switch(JSON.parse(t.data).type){case"join":e.messages.push(JSON.parse(t.data).message+"が入室しました。"),e.users.push(JSON.parse(t.data).message);break;case"message":e.messages.push(JSON.parse(t.data).message);break;case"roles":var n=JSON.parse(t.data).userRoles;e.role=n[e.yourName],e.messages=[],e.messages.push("あなたの役職は"+e.role+"です。"),e.roles.forEach((function(t){t.name===e.role&&e.messages.push(t.description)}));var s=0;Object.entries(n).map((function(t){var n=Object(o["a"])(t,2),r=n[0],a=n[1],i={};i=r==e.yourName?{name:r,role:a,design:a,num:s,votedNum:0}:{name:r,role:a,design:"back",num:s,votedNum:0},i.name.match(/^notAssigned/)?e.insideCards.push(i):e.outsideCards.push(i),s++})),"人狼"==e.role&&e.outsideCards.forEach((function(t){"人狼"===t.role&&t.name!==e.yourName&&(t.design=t.role,e.outsideCards.splice(t.num,1,t),e.messages.push(t.name+"さんも人狼です"))})),e.status="morning",e.nightPeriodSecond=20;break;case"vote":"怪盗"==JSON.parse(t.data).role&&(e.resultOutsideCards=JSON.parse(t.data).outsideCards);var r=JSON.parse(t.data).votedUser;if(e.outsideCards.forEach((function(t){t.name==r&&(t.votedNum++,e.outsideCards.splice(t.num,1,t))})),e.votedCounter++,e.votedCounter>=e.users.length){var a=Math.max.apply(Math,Object(i["a"])(e.outsideCards.map((function(e){return e.votedNum})))),c=e.outsideCards.filter((function(e){return e.votedNum==a}));e.messages=[],c.forEach((function(t){e.messages.push(t.name+"が処刑されました")})),c.filter((function(e){return"人狼"==e.role})).length>0?e.messages.push("人狼を処刑したので村人陣営の勝利です"):e.messages.push("村人陣営のユーザが処刑されたので人狼陣営の勝利です");for(var u=0;u<2;u++){var l=e.insideCards[u];l.design=l.role,e.insideCards.splice(u,1,l)}e.outsideCards.forEach((function(t){if(e.resultOutsideCards.length>0){var n=e.resultOutsideCards.filter((function(e){return e.name===t.name}))[0];t.design=n.role}else t.design=t.role;e.outsideCards.splice(t.num,1,t)})),e.status="resultAnnouncement"}break;default:console.log(JSON.parse(t.data)),e.messages.push("予期せぬデータを受信しました")}},this.connection.onopen=function(e){console.log(e),console.log("Successfully connected to the echo websocket server...")}}},E=T,P=(n("034f"),n("7496")),M=n("40dc"),$=n("b0af"),R=n("99d9"),U=n("a523"),G=n("169a"),D=n("ce7e"),B=n("67b6"),I=n("43a6"),q=n("0fd9"),W=n("2fa4"),z=n("2a7f"),H=Object(m["a"])(E,r,a,!1,null,null,null),L=H.exports;_()(H,{VApp:P["a"],VAppBar:M["a"],VBtn:y["a"],VCard:$["a"],VCardActions:R["a"],VCardText:R["b"],VCardTitle:R["c"],VContainer:U["a"],VDialog:G["a"],VDivider:D["a"],VRadio:B["a"],VRadioGroup:I["a"],VRow:q["a"],VSpacer:W["a"],VToolbarTitle:z["a"]});var X=n("f309");s["a"].use(X["a"]);var K=new X["a"]({}),Q=n("1fb0"),Y=n.n(Q),Z=n("8c4f");s["a"].use(Z["a"]);var ee=new Z["a"]({mode:"history",routes:[{path:"/",name:"registerNameForm",component:S},{path:"/choiceRole/:usersCount",name:"choiceRole",component:J,props:!0}]});s["a"].config.productionTip=!1,s["a"].component("number-input-spinner",Y.a),new s["a"]({router:ee,vuetify:K,render:function(e){return e(L)}}).$mount("#app")},"85ec":function(e,t,n){},ab5e:function(e,t,n){},be89:function(e,t,n){"use strict";var s=n("1b4f"),r=n.n(s);r.a},d016:function(e,t,n){"use strict";var s=n("ab5e"),r=n.n(s);r.a}});
//# sourceMappingURL=app.eb4ff3c7.js.map